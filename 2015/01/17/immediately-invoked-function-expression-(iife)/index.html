<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Immediately-Invoked Function Expression (IIFE) | GYF1</title>
  <meta name="author" content="GYF1">
  
  <meta name="description" content="郭银锋 | 程序员 | JavaScript | CSS">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Immediately-Invoked Function Expression (IIFE)"/>
  <meta property="og:site_name" content="GYF1"/>

  
    <meta property="og:image" content="undefined"/>
  

  <!--<meta name="baidu-site-verification" content="ZDIDoHeMEZ" />-->
  <!--<meta name="baidu_union_verify" content="579c32c6acaf563a65fed2fa8575ebd3">-->

  <!-- <link href="/favicon.png" rel="icon"> -->
  <link href="/favicon.ico" rel="icon" type="image/x-ico">


  <link rel="alternate" href="/atom.xml" title="GYF1" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">GYF1</a></h1>
  <h2><a href="/">Web Platform, Cloud and Mobile Application Development</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">存档</a></li>
    
      <li><a href="/atom.xml">RSS</a></li>
    
      <li><a href="https://github.com/guoyinfeng">GitHub</a></li>
    
      <li><a href="/note">Note</a></li>
    
      <li><a href="/thinking">Thinking</a></li>
    
      <li><a href="/bookmark">Bookmark</a></li>
    
      <li><a href="/about">关于</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-01-17T08:23:22.000Z"><a href="/2015/01/17/immediately-invoked-function-expression-(iife)/">1月 17 2015</a></time>
      
      
  
    <h1 class="title">Immediately-Invoked Function Expression (IIFE)</h1>
  

    </header>
    <div class="entry">
      
        <p>In case you hadn&#x2019;t noticed, I&#x2019;m a bit of a stickler for terminology. So, after hearing the popular, yet misleading, JavaScript term &#x201C;self-executing anonymous function&#x201D; (or self-invoked anonymous function) one too many times, I&#x2019;ve finally decided to organize my thoughts into an article.</p>
<p>In addition to providing some very thorough information about how this pattern actually works, I&#x2019;ve actually made a recommendation on what we should call it, moving forward. Also, If you want to skip ahead, you can just check out some actual Immediately-Invoked Function Expressions, but I recommend reading the entire article.</p>
<p>Please understand that this article isn&#x2019;t intended to be an &#x201C;I&#x2019;m right, you&#x2019;re wrong&#x201D; kind of thing. I&#x2019;m genuinely interested in helping people understand potentially complex concepts, and feel that using consistent and accurate terminology is one of the easiest things that people can do to facilitate understanding.</p>
<a id="more"></a>

<h1 id="&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x53EF;&#x4EE5;&#x5E2E;&#x7EC4;&#x6211;&#x4EEC;&#x89E3;&#x51B3;&#x4EC0;&#x4E48;&#x95EE;&#x9898;">&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x53EF;&#x4EE5;&#x5E2E;&#x7EC4;&#x6211;&#x4EEC;&#x89E3;&#x51B3;&#x4EC0;&#x4E48;&#x95EE;&#x9898;</h1>
<p>&#x5728;js&#x4E2D;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;function&#xFF0C;&#x5F53;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x90FD;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;context&#x3002;<br>&#x56E0;&#x4E3A;&#x5B9A;&#x4E49;&#x5728;function&#x91CC;&#x9762;&#x7684;variables&#x6216;&#x8005;function, &#x53EA;&#x80FD;&#x5728;&#x8FD9;&#x4E2A;function&#x91CC;&#x8BBF;&#x95EE;&#x3002;<br>&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x662F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F88;&#x65B9;&#x4FBF;&#x7684;&#x5B9A;&#x4E49;&#x79C1;&#x6709;&#x53D8;&#x91CF;&#x3002;</p>
<pre><code><span class="regexp">//</span> Because <span class="keyword">this</span> <span class="reserved">function</span> returns another <span class="reserved">function</span> that has access to the
<span class="regexp">//</span> <span class="string">&quot;private&quot;</span> <span class="reserved">var</span> i, the returned <span class="reserved">function</span> <span class="keyword">is</span>, effectively, <span class="string">&quot;privileged.&quot;</span>

<span class="reserved">function</span> makeCounter() {
  <span class="regexp">//</span> `<span class="javascript">i</span>` <span class="keyword">is</span> only accessible inside `<span class="javascript">makeCounter</span>`.
  <span class="reserved">var</span> i = <span class="number">0</span>;

  <span class="keyword">return</span> <span class="reserved">function</span>() {
    <span class="built_in">console</span>.log( ++i );
  };
}

<span class="regexp">//</span> Note that `<span class="javascript">counter</span>` <span class="keyword">and</span> `<span class="javascript">counter2</span>` each have their own scoped `<span class="javascript">i</span>`.

<span class="reserved">var</span> counter = makeCounter();
counter(); <span class="regexp">//</span> <span class="attribute">logs</span>: <span class="number">1</span>
counter(); <span class="regexp">//</span> <span class="attribute">logs</span>: <span class="number">2</span>

<span class="reserved">var</span> counter2 = makeCounter();
counter2(); <span class="regexp">//</span> <span class="attribute">logs</span>: <span class="number">1</span>
counter2(); <span class="regexp">//</span> <span class="attribute">logs</span>: <span class="number">2</span>

i; <span class="regexp">//</span> <span class="attribute">ReferenceError</span>: i <span class="keyword">is</span> <span class="keyword">not</span> defined (it only exists inside makeCounter)
</code></pre><p>&#x4E0D;&#x8FC7;&#x6709;&#x4E9B;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x5E76;&#x4E0D;&#x60F3;&#x8981;&#x591A;&#x4E2A;instance&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x60F3;&#x8981;&#x4E00;&#x4E2A;instance&#xFF1B;&#x800C;&#x4E14;&#x5728;&#x6709;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x90FD;&#x4E0D;&#x9700;&#x8981;&#x8FD4;&#x56DE;&#x503C;&#x3002;</p>
<h2 id="&#x95EE;&#x9898;&#x7684;&#x6838;&#x5FC3;">&#x95EE;&#x9898;&#x7684;&#x6838;&#x5FC3;</h2>
<p>&#x4E0D;&#x8FC7;&#x4F60;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;function&#x7C7B;&#x4F3C;&#x4E8E;</p>
<pre><code><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span>{</span>}
</code></pre><p>&#x8FD8;&#x662F;</p>
<pre><code><span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>}
</code></pre><p>&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x90FD;&#x662F;&#x4EE5;function&#x7684;identifier&#x7ED3;&#x675F;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;identifier&#xFF08;&#x8FD9;&#x91CC;&#x6307;&#x7684;&#x662F;foo&#xFF09;&#x7684;&#x540E;&#x9762;&#x589E;&#x52A0;&#x53CC;&#x62EC;&#x53F7;&#x6765;&#x8C03;&#x7528;&#x7684;function</p>
<pre><code><span class="comment">// Because a function defined like so can be invoked by putting () after</span>
<span class="comment">// the function name, like foo(), and because foo is just a reference to</span>
<span class="comment">// the function expression `function() { /* code */ }`...</span>

<span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }

<span class="comment">// ...doesn&apos;t it stand to reason that the function expression itself can</span>
<span class="comment">// be invoked, just by putting () after it?</span>

<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }(); <span class="comment">// SyntaxError: Unexpected token (</span>
</code></pre><p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x5F53;&#x89E3;&#x91CA;&#x5668;&#x9047;&#x5230;function&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x628A;&#x5B83;&#x770B;&#x6210;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x58F0;&#x660E;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x3002;<br>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x660E;&#x786E;&#x7684;&#x544A;&#x8BC9;&#x89E3;&#x91CA;&#x5668;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x7684;&#x662F;&#x51FD;&#x6570;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x89E3;&#x91CA;&#x5668;&#x8BEF;&#x8BA4;&#x4E3A;&#x6211;&#x4EEC;&#x5728;&#x505A;&#x51FD;&#x6570;&#x7684;&#x58F0;&#x660E;&#xFF0C;&#x4F46;&#x662F;&#x5374;&#x627E;&#x4E0D;&#x5230;&#x51FD;&#x6570;&#x540D;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x4F1A;&#x62A5;&#x9519;&#x3002;</p>
<h2 id="An_aside:_functions,_parens,_and_SyntaxErrors">An aside: functions, parens, and SyntaxErrors</h2>
<p>&#x5F88;&#x6709;&#x8DA3;&#x7684;&#x662F;&#xFF0C;&#x5373;&#x4F7F;&#x4F60;&#x7ED9;&#x4E86;&#x51FD;&#x6570;&#x540D;&#x548C;&#x51FD;&#x6570;&#x53C2;&#x6570;&#xFF0C;&#x540C;&#x6837;&#x8FD8;&#x662F;&#x4F1A;&#x6709;&#x8BED;&#x6CD5;&#x9519;&#x8BEF;&#xFF0C;&#x4F46;&#x662F;&#x9519;&#x8BEF;&#x539F;&#x56E0;&#x4E0D;&#x540C;&#x3002;<br>&#x4E0D;&#x8FC7;&#x5982;&#x679C;&#x5728;&#x53CC;&#x62EC;&#x53F7;&#x91CC;&#x7ED9;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x4E0D;&#x62A5;&#x9519;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x51FD;&#x6570;&#x4E5F;&#x4E0D;&#x6267;&#x884C;&#xFF0C;&#x56E0;&#x4E3A;&#x89E3;&#x91CA;&#x5668;&#x628A;&#x5E26;&#x6709;&#x53C2;&#x6570;&#x7684;&#x53CC;&#x62EC;&#x53F7;&#x548C;&#x524D;&#x9762;&#x7684;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x5B8C;&#x5168;&#x770B;&#x6210;&#x662F;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x4E1C;&#x897F;&#x3002;</p>
<pre><code><span class="comment">// While this function declaration is now syntactically valid, it&apos;s still</span>
<span class="comment">// a statement, and the following set of parens is invalid because the</span>
<span class="comment">// grouping operator needs to contain an expression.</span>

<span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }(); <span class="comment">// SyntaxError: Unexpected token )</span>

<span class="comment">// Now, if you put an expression in the parens, no exception is thrown...</span>
<span class="comment">// but the function isn&apos;t executed either, because this:</span>

<span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }( <span class="number">1</span> );

<span class="comment">// Is really just equivalent to this, a function declaration followed by a</span>
<span class="comment">// completely unrelated expression:</span>

<span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }

( <span class="number">1</span> );
</code></pre><h1 id="&#x81EA;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;">&#x81EA;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;</h1>
<p>Immediately-Invoked Function Expression (IIFE)<br>&#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#x5BB9;&#x6613;&#x7684;&#x3002;<br>&#x4E3A;&#x4E86;&#x544A;&#x8BC9;&#x89E3;&#x91CA;&#x5668;&#xFF0C;&#x90A3;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x5C06;&#x51FD;&#x6570;&#x7684;&#x5B9A;&#x4E49;&#x653E;&#x5230;&#x4E00;&#x4E2A;&#x62EC;&#x53F7;&#x91CC;&#x9762;&#x53BB;&#x3002;</p>
<pre><code><span class="comment">// Either of the following two patterns can be used to immediately invoke</span>
<span class="comment">// a function expression, utilizing the function&apos;s execution context to</span>
<span class="comment">// create &quot;privacy.&quot;</span>

(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }()); <span class="comment">// Crockford recommends this one</span>
(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> })(); <span class="comment">// But this one works just as well</span>

<span class="comment">// Because the point of the parens or coercing operators is to disambiguate</span>
<span class="comment">// between function expressions and function declarations, they can be</span>
<span class="comment">// omitted when the parser already expects an expression (but please see the</span>
<span class="comment">// &quot;important note&quot; below).</span>

<span class="keyword">var</span> i = <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="keyword">return</span> <span class="number">10</span>; }();
<span class="literal">true</span> &amp;&amp; <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }();
<span class="number">0</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }();

<span class="comment">// If you don&apos;t care about the return value, or the possibility of making</span>
<span class="comment">// your code slightly harder to read, you can save a byte by just prefixing</span>
<span class="comment">// the function with a unary operator.</span>

!<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }();
~<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }();
-<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }();
+<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }();

<span class="comment">// Here&apos;s another variation, from @kuvos - I&apos;m not sure of the performance</span>
<span class="comment">// implications, if any, of using the `new` keyword, but it works.</span>
<span class="comment">// http://twitter.com/kuvos/status/18209252090847232</span>

<span class="keyword">new</span> <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }
<span class="keyword">new</span> <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> <span class="comment">/* code */</span> }() <span class="comment">// Only need parens if passing arguments</span>
</code></pre><h2 id="&#x5173;&#x4E8E;&#x62EC;&#x53F7;&#x7684;&#x4E00;&#x4E9B;&#x8BF4;&#x660E;">&#x5173;&#x4E8E;&#x62EC;&#x53F7;&#x7684;&#x4E00;&#x4E9B;&#x8BF4;&#x660E;</h2>
<p>&#x6709;&#x62EC;&#x53F7;&#x867D;&#x7136;&#x591A;&#x4F59;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x53EF;&#x8BFB;&#x6027;&#x4E0A;&#x4F1A;&#x597D;&#x5F88;&#x591A;&#xFF0C;&#x907F;&#x514D;&#x522B;&#x4EBA;&#x770B;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x8FD8;&#x9700;&#x8981;&#x62D6;&#x52A8;&#x5230;&#x6700;&#x4E0B;&#x9762;&#x770B;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x662F;&#x4E0D;&#x662F;&#x76F4;&#x63A5;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x3002;<br>&#x8FD9;&#x6837;&#x5B50;&#x522B;&#x4EBA;&#x770B;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x624D;&#x4E0D;&#x4F1A;&#x62B1;&#x6028;&#x4F60;&#x3002;</p>
<h2 id="&#x7528;&#x95ED;&#x5305;&#x4FDD;&#x5B58;&#x72B6;&#x6001;">&#x7528;&#x95ED;&#x5305;&#x4FDD;&#x5B58;&#x72B6;&#x6001;</h2>
<p>&#x6211;&#x4EEC;&#x5728;&#x8C03;&#x7528;&#x666E;&#x901A;&#x51FD;&#x6570;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x4F20;&#x53C2;&#x6570;&#xFF0C;&#x5F53;&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x6267;&#x884C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5F80;&#x91CC;&#x9762;&#x4F20;&#x53C2;&#x6570;&#x3002;<br>&#x800C;&#x4E14;&#x5728;&#x51FD;&#x6570;&#x91CC;&#x9762;&#x5B9A;&#x4E49;&#x7684;&#x5B50;&#x51FD;&#x6570;&#xFF0C;&#x662F;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x5230;&#x7236;&#x4EB2;&#x51FD;&#x6570;&#x62FF;&#x5230;&#x7684;&#x53C2;&#x6570;&#x7684;-&gt; &#x8FD9;&#x79CD;&#x5C31;&#x662F;&#x5E38;&#x8BF4;&#x7684;&#x95ED;&#x5305;&#x3002;<br>&#x81EA;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x5F88;&#x597D;&#x7684;lock in values, &#x5E76;&#x4E14;&#x6709;&#x6548;&#x7684;&#x4FDD;&#x5B58;&#x72B6;&#x6001;&#x3002;</p>
<pre><code><span class="regexp">//</span> This doesn<span class="string">&apos;t work like you might think, because the value of `i` never
// gets locked in. Instead, every link, when clicked (well after the loop
// has finished executing), alerts the total number of elements, because
// that&apos;</span>s what the value <span class="keyword">of</span> `<span class="javascript">i</span>` actually <span class="keyword">is</span> at that point.

<span class="reserved">var</span> elems = <span class="built_in">document</span>.getElementsByTagName( <span class="string">&apos;a&apos;</span> );

<span class="keyword">for</span> ( <span class="reserved">var</span> i = <span class="number">0</span>; i &lt; elems.length; i++ ) {

  elems[ i ].addEventListener( <span class="string">&apos;click&apos;</span>, <span class="reserved">function</span>(e){
    e.preventDefault();
    alert( <span class="string">&apos;I am link #&apos;</span> + i );
  }, <span class="string">&apos;false&apos;</span> );

}

<span class="regexp">//</span> This works, because inside the IIFE, the value <span class="keyword">of</span> `<span class="javascript">i</span>` <span class="keyword">is</span> locked <span class="keyword">in</span> as
<span class="regexp">//</span> `<span class="javascript">lockedInIndex</span>`. After the <span class="keyword">loop</span> has finished executing, even though the
<span class="regexp">//</span> value <span class="keyword">of</span> `<span class="javascript">i</span>` <span class="keyword">is</span> the total number <span class="keyword">of</span> elements, inside the IIFE the value
<span class="regexp">//</span> <span class="keyword">of</span> `<span class="javascript">lockedInIndex</span>` <span class="keyword">is</span> whatever the value passed into it (`<span class="javascript">i</span>`) was <span class="keyword">when</span>
<span class="regexp">//</span> the <span class="reserved">function</span> expression was invoked, so <span class="keyword">when</span> a link <span class="keyword">is</span> clicked, the
<span class="regexp">//</span> correct value <span class="keyword">is</span> alerted.

<span class="reserved">var</span> elems = <span class="built_in">document</span>.getElementsByTagName( <span class="string">&apos;a&apos;</span> );

<span class="keyword">for</span> ( <span class="reserved">var</span> i = <span class="number">0</span>; i &lt; elems.length; i++ ) {

  (<span class="reserved">function</span>( lockedInIndex ){

    elems[ i ].addEventListener( <span class="string">&apos;click&apos;</span>, <span class="reserved">function</span>(e){
      e.preventDefault();
      alert( <span class="string">&apos;I am link #&apos;</span> + lockedInIndex );
    }, <span class="string">&apos;false&apos;</span> );

  })( i );

}

<span class="regexp">//</span> You could also use an IIFE like <span class="keyword">this</span>, encompassing (<span class="keyword">and</span> returning) only
<span class="regexp">//</span> the click handler <span class="reserved">function</span>, <span class="keyword">and</span> <span class="keyword">not</span> the entire `<span class="javascript">addEventListener</span>`
<span class="regexp">//</span> assignment. Either way, <span class="keyword">while</span> both examples lock <span class="keyword">in</span> the value using an
<span class="regexp">//</span> IIFE, I find the previous example to be more readable.

<span class="reserved">var</span> elems = <span class="built_in">document</span>.getElementsByTagName( <span class="string">&apos;a&apos;</span> );

<span class="keyword">for</span> ( <span class="reserved">var</span> i = <span class="number">0</span>; i &lt; elems.length; i++ ) {

  elems[ i ].addEventListener( <span class="string">&apos;click&apos;</span>, (<span class="reserved">function</span>( lockedInIndex ){
    <span class="keyword">return</span> <span class="reserved">function</span>(e){
      e.preventDefault();
      alert( <span class="string">&apos;I am link #&apos;</span> + lockedInIndex );
    };
  })( i ), <span class="string">&apos;false&apos;</span> );

}
</code></pre><h2 id="&#x201C;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x7684;&#x533F;&#x540D;&#x51FD;&#x6570;&#x201D;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x597D;&#xFF1F;">&#x201C;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x7684;&#x533F;&#x540D;&#x51FD;&#x6570;&#x201D;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x597D;&#xFF1F;</h2>
<p>&#x6211;&#x66F4;&#x504F;&#x5411;&#x4E8E;&#x201C;&#x81EA;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x8868;&#x8FBE;&#x5F0F;&#x201D;&#x8FD9;&#x79CD;&#x8BF4;&#x6CD5;&#x3002;&#x56E0;&#x4E3A;&#x6211;&#x89C9;&#x5F97;&#x201C;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x7684;&#x533F;&#x540D;&#x51FD;&#x6570;&#x201D;&#x4E0D;&#x592A;&#x597D;&#x7406;&#x89E3;&#x3002;</p>
<pre><code><span class="comment">// This is a self-executing function. It&apos;s a function that executes (or</span>
<span class="comment">// invokes) itself, recursively:</span>

<span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> { <span class="title">foo</span><span class="params">()</span>; }</span>

<span class="comment">// This is a self-executing anonymous function. Because it has no</span>
<span class="comment">// identifier, it must use the  the `arguments.callee` property (which</span>
<span class="comment">// specifies the currently executing function) to execute itself.</span>

var foo = <span class="function"><span class="keyword">function</span><span class="params">()</span> { <span class="title">arguments</span>.<span class="title">callee</span><span class="params">()</span>; };</span>

<span class="comment">// This *might* be a self-executing anonymous function, but only while the</span>
<span class="comment">// `foo` identifier actually references it. If you were to change `foo` to</span>
<span class="comment">// something else, you&apos;d have a &quot;used-to-self-execute&quot; anonymous function.</span>

var foo = <span class="function"><span class="keyword">function</span><span class="params">()</span> { <span class="title">foo</span><span class="params">()</span>; };</span>

<span class="comment">// Some people call this a &quot;self-executing anonymous function&quot; even though</span>
<span class="comment">// it&apos;s not self-executing, because it doesn&apos;t invoke itself. It is</span>
<span class="comment">// immediately invoked, however.</span>

(<span class="function"><span class="keyword">function</span><span class="params">()</span>{ /* <span class="title">code</span> */ }<span class="params">()</span>);</span>

<span class="comment">// Adding an identifier to a function expression (thus creating a named</span>
<span class="comment">// function expression) can be extremely helpful when debugging. Once named,</span>
<span class="comment">// however, the function is no longer anonymous.</span>

(<span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span>{ /* <span class="title">code</span> */ }<span class="params">()</span>);</span>

<span class="comment">// IIFEs can also be self-executing, although this is, perhaps, not the most</span>
<span class="comment">// useful pattern.</span>

(<span class="function"><span class="keyword">function</span><span class="params">()</span>{ <span class="title">arguments</span>.<span class="title">callee</span><span class="params">()</span>; }<span class="params">()</span>);</span>
(<span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span>{ <span class="title">foo</span><span class="params">()</span>; }<span class="params">()</span>);</span>

<span class="comment">// One last thing to note: this will cause an error in BlackBerry 5, because</span>
<span class="comment">// inside a named function expression, that name is undefined. Awesome, huh?</span>

(<span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span>{ <span class="title">foo</span><span class="params">()</span>; }<span class="params">()</span>);</span>
</code></pre><h2 id="&#x6700;&#x540E;&#x4E00;&#x70B9;&#xFF0C;&#x6A21;&#x5757;&#x6A21;&#x5F0F;">&#x6700;&#x540E;&#x4E00;&#x70B9;&#xFF0C;&#x6A21;&#x5757;&#x6A21;&#x5F0F;</h2>
<p>&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x719F;&#x6089;&#x201C;&#x6A21;&#x5757;&#x6A21;&#x5F0F;&#x201D;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x4E00;&#x4E0B;&#x6211;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x6A21;&#x5757;&#x6A21;&#x5F0F;&#x5DEE;&#x4E0D;&#x591A;&#x5C31;&#x662F;&#x8FD9;&#x6837;&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x8FD4;&#x56DE;&#x7684;&#x4E0D;&#x662F;&#x51FD;&#x6570;&#xFF0C;&#x800C;&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x3002;</p>
<pre><code><span class="comment">// Create an anonymous function expression that gets invoked immediately,</span>
<span class="comment">// and assign its *return value* to a variable. This approach &quot;cuts out the</span>
<span class="comment">// middleman&quot; of the named `makeWhatever` function reference.</span>
<span class="comment">//</span>
<span class="comment">// As explained in the above &quot;important note,&quot; even though parens are not</span>
<span class="comment">// required around this function expression, they should still be used as a</span>
<span class="comment">// matter of convention to help clarify that the variable is being set to</span>
<span class="comment">// the function&apos;s *result* and not the function itself.</span>

<span class="keyword">var</span> counter = (<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
  <span class="keyword">var</span> i = <span class="number">0</span>;

  <span class="keyword">return</span> {
    <span class="keyword">get</span>: <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
      <span class="keyword">return</span> i;
    },
    <span class="keyword">set</span>: <span class="function"><span class="keyword">function</span><span class="params">( val )</span>{</span>
      i = val;
    },
    increment: <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
      <span class="keyword">return</span> ++i;
    }
  };
}());

<span class="comment">// `counter` is an object with properties, which in this case happen to be</span>
<span class="comment">// methods.</span>

counter.<span class="keyword">get</span>(); <span class="comment">// 0</span>
counter.<span class="keyword">set</span>( <span class="number">3</span> );
counter.increment(); <span class="comment">// 4</span>
counter.increment(); <span class="comment">// 5</span>

counter.i; <span class="comment">// undefined (`i` is not a property of the returned object)</span>
i; <span class="comment">// ReferenceError: i is not defined (it only exists inside the closure)</span>
</code></pre><p>&#x6A21;&#x5757;&#x6A21;&#x5F0F;&#x4E0D;&#x4EC5;&#x4EC5;&#x662F;&#x975E;&#x5E38;&#x5F3A;&#x5927;&#xFF0C;&#x4E5F;&#x662F;&#x975E;&#x5E38;&#x7684;&#x7B80;&#x5355;&#x3002;&#x5229;&#x7528;&#x5F88;&#x5C11;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5C01;&#x88C5;&#x76F8;&#x5173;&#x7684;&#x5C5E;&#x6027;&#x548C;&#x65B9;&#x6CD5;&#x3002;<br>&#x901A;&#x8FC7;&#x6A21;&#x5757;&#x6A21;&#x5F0F;&#x8FD8;&#x53EF;&#x4EE5;&#x6700;&#x5927;&#x9650;&#x5EA6;&#x7684;&#x964D;&#x4F4E;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x7684;&#x98CE;&#x9669;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x79C1;&#x6709;&#x6210;&#x5458;&#x3002;</p>
<pre><code>&#x4EA7;&#x8BC1;&#x51E0;&#x4E2A;&#x4EBA;&#xFF1F;


&#x770B;&#x4E2D;&#x4E86;&#x540E;&#x9700;&#x8981;&#x591A;&#x5C11;&#x5148;&#x7ED9;&#x591A;&#x5C11;&#x8BA2;&#x91D1;
&#x8BA2;&#x91D1;&#x7ED9;&#x540E;&#xFF0C;&#x591A;&#x5C11;&#x5929;&#x7ED9;&#x9996;&#x4ED8;
&#x9996;&#x4ED8;&#x7ED9;&#x5B8C;&#xFF0C;&#x8D37;&#x6B3E;&#x671F;&#x7ED9;&#x591A;&#x5C11;

&#x4E0D;&#x552F;&#x4E00;&#x7684;&#x8D39;&#x7528;&#x8C01;&#x7ED9;

&#x5BB6;&#x91CC;&#x968F;&#x65F6;&#x53EF;&#x4EE5;&#x770B;&#x623F;&#xFF1F;
</code></pre><p>&#x539F;&#x6587;<br><a href="http://benalman.com/news/2010/11/immediately-invoked-function-expression/" target="_blank" rel="external">http://benalman.com/news/2010/11/immediately-invoked-function-expression/</a></p>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/javascript/">JavaScript</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/translation/">Translation</a>
  </div>

        <div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a title="分享到新浪微博" href="#" class="bds_tsina" data-cmd="tsina"></a><a title="分享到微信" href="#" class="bds_weixin" data-cmd="weixin"></a><a title="分享到QQ空间" href="#" class="bds_qzone" data-cmd="qzone"></a><a title="分享到腾讯微博" href="#" class="bds_tqq" data-cmd="tqq"></a><a title="分享到人人网" href="#" class="bds_renren" data-cmd="renren"></a></div>
        <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{},"image":{"viewList":["tsina","weixin","qzone","tqq","renren"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","weixin","qzone","tqq","renren"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
        
<div class="prev_next clearfix">
  
    <a href="/2015/01/17/js里的原型和继承/" class="alignleft prev" title="js里的原型和继承">js里的原型和继承</a>
  
  
    <a href="/2015/01/17/understanding-angular’s-apply()-and-digest()/" class="alignright next" title="Understanding Angular’s apply() and digest()">Understanding Angular’s apply() and digest()</a>
  
</div>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <!-- <h1 class="title">留言</h1>

  
      <div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789012345";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-comments" data-href="http://blog.gyf1.com/2015/01/17/immediately-invoked-function-expression-(iife)/" data-num-posts="5" data-width="840" data-colorscheme="light"></div>
      
   -->

  <!-- Duoshuo Comment BEGIN -->
  <div class="ds-thread"></div>
  <script type="text/javascript">
  var duoshuoQuery = {short_name:"gyf"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = 'http://static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0] 
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
  <!-- Duoshuo Comment END -->
</section>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:blog.gyf1.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/cloud/">Cloud</a><small>5</small></li>
  
    <li><a href="/categories/database/">Database</a><small>5</small></li>
  
    <li><a href="/categories/giant/">Giant</a><small>96</small></li>
  
    <li><a href="/categories/html/">HTML</a><small>7</small></li>
  
    <li><a href="/categories/innovation/">Innovation</a><small>3</small></li>
  
    <li><a href="/categories/javascript/">JavaScript</a><small>68</small></li>
  
    <li><a href="/categories/others/">Others</a><small>10</small></li>
  
    <li><a href="/categories/portfolio/">Portfolio</a><small>7</small></li>
  
    <li><a href="/categories/salesforce/">Salesforce</a><small>9</small></li>
  
    <li><a href="/categories/software-engineering/">Software Engineering</a><small>20</small></li>
  
    <li><a href="/categories/style/">Style</a><small>22</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/agile-development/" style="font-size: 13.00px;">Agile Development</a><a href="/tags/angularjs/" style="font-size: 20.00px;">AngularJS</a><a href="/tags/apex/" style="font-size: 12.00px;">Apex</a><a href="/tags/bootstrap/" style="font-size: 14.00px;">Bootstrap</a><a href="/tags/bower/" style="font-size: 11.00px;">Bower</a><a href="/tags/css/" style="font-size: 18.00px;">CSS</a><a href="/tags/certification/" style="font-size: 11.00px;">Certification</a><a href="/tags/coffeescript/" style="font-size: 11.00px;">CoffeeScript</a><a href="/tags/commonjs/" style="font-size: 10.00px;">CommonJS</a><a href="/tags/compass/" style="font-size: 10.00px;">Compass</a><a href="/tags/design-pattern/" style="font-size: 15.00px;">Design Pattern</a><a href="/tags/dojo/" style="font-size: 10.00px;">Dojo</a><a href="/tags/english/" style="font-size: 11.00px;">English</a><a href="/tags/express/" style="font-size: 10.00px;">Express</a><a href="/tags/geddy/" style="font-size: 10.00px;">Geddy</a><a href="/tags/git/" style="font-size: 11.00px;">Git</a><a href="/tags/golang/" style="font-size: 10.00px;">Golang</a><a href="/tags/grunt/" style="font-size: 11.00px;">Grunt</a><a href="/tags/html5/" style="font-size: 13.00px;">HTML5</a><a href="/tags/haxe/" style="font-size: 10.00px;">Haxe</a><a href="/tags/heroku/" style="font-size: 13.00px;">Heroku</a><a href="/tags/ionic/" style="font-size: 10.00px;">Ionic</a><a href="/tags/jshint/" style="font-size: 11.00px;">JSHint</a><a href="/tags/jasmine/" style="font-size: 10.00px;">Jasmine</a><a href="/tags/karma/" style="font-size: 11.00px;">Karma</a><a href="/tags/less/" style="font-size: 10.00px;">LESS</a><a href="/tags/learning/" style="font-size: 19.00px;">Learning</a><a href="/tags/memcache/" style="font-size: 10.00px;">Memcache</a><a href="/tags/meteor/" style="font-size: 10.00px;">Meteor</a><a href="/tags/mongodb/" style="font-size: 12.00px;">MongoDB</a><a href="/tags/mongoose/" style="font-size: 11.00px;">Mongoose</a><a href="/tags/mootools/" style="font-size: 10.00px;">MooTools</a><a href="/tags/nodejs/" style="font-size: 17.00px;">Node.js</a><a href="/tags/phantomjs/" style="font-size: 10.00px;">Phantomjs</a><a href="/tags/postgres/" style="font-size: 10.00px;">Postgres</a><a href="/tags/protractor/" style="font-size: 10.00px;">Protractor</a><a href="/tags/ratchet/" style="font-size: 10.00px;">Ratchet</a><a href="/tags/redis/" style="font-size: 10.00px;">Redis</a><a href="/tags/requirejs/" style="font-size: 10.00px;">RequireJS</a><a href="/tags/riak/" style="font-size: 10.00px;">Riak</a><a href="/tags/sass/" style="font-size: 11.00px;">SASS</a><a href="/tags/stylus/" style="font-size: 10.00px;">Stylus</a><a href="/tags/teamcity/" style="font-size: 10.00px;">TeamCity</a><a href="/tags/titanium/" style="font-size: 10.00px;">Titanium</a><a href="/tags/translation/" style="font-size: 14.00px;">Translation</a><a href="/tags/ucd/" style="font-size: 10.00px;">UCD</a><a href="/tags/ued/" style="font-size: 10.00px;">UED</a><a href="/tags/visualforce/" style="font-size: 12.00px;">Visualforce</a><a href="/tags/webstorm/" style="font-size: 14.00px;">WebStorm</a><a href="/tags/yslow/" style="font-size: 10.00px;">YSlow</a><a href="/tags/yui/" style="font-size: 10.00px;">YUI</a><a href="/tags/yeoman/" style="font-size: 10.00px;">Yeoman</a><a href="/tags/jquery/" style="font-size: 16.00px;">jQuery</a>
  </div>
</div>


  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/2015/01/25/closures-in-javascript/">Closures in JavaScript</a>
      </li>
    
      <li>
        <a href="/2015/01/23/angularjs-style-guide/">AngularJS Style Guide</a>
      </li>
    
      <li>
        <a href="/2015/01/22/js-tests/">js tests</a>
      </li>
    
      <li>
        <a href="/2015/01/22/css-tests/">css tests</a>
      </li>
    
      <li>
        <a href="/2015/01/22/10-digest()-iterations-reached-aborting/">10 digest() iterations reached. Aborting</a>
      </li>
    
      <li>
        <a href="/2015/01/22/关于javascript中apply()和call()方法的区别z/">关于javascript中apply()和call()方法的区别z</a>
      </li>
    
      <li>
        <a href="/2015/01/20/maximum-call-stack-size-exceeded/">Maximum call stack size exceeded</a>
      </li>
    
      <li>
        <a href="/2015/01/18/getting-over-jquery/">Getting Over jQuery</a>
      </li>
    
      <li>
        <a href="/2015/01/18/understanding-prototypes-in-javascript/">Understanding Prototypes in JavaScript</a>
      </li>
    
      <li>
        <a href="/2015/01/17/js里的原型和继承/">js里的原型和继承</a>
      </li>
    
  </ul>
</div>


  <iframe 
	width="100%" 
	height="600" 
	class="share_self"  
	frameborder="0" 
	scrolling="no" 
	src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=0&speed=0&skin=5&isTitle=1&noborder=1&isWeibo=1&isFans=0&uid=3988939492&verifier=76ceba5c&dpc=1"
	>
</iframe>
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 GYF1
  
</div>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


<div id="totop" style="position:fixed;bottom:150px;right:50px;cursor: pointer;">
<a title="返回顶部"><img src="/imgs/scrollup.png"/></a>
</div>
<script src="/js/totop.js"></script>

</body>
</html>